#!/usr/bin/env node
import { Command } from 'commander';
import debug from './debug.js';
import init from './init.js';
import mongo from './mongo.js';
import test from './test.js';
import update from './update.js';

const program = new Command();
program
  .name('plugga')
  .description(
    'A plugga.tech CLI tool to install and run assignment tests in your own project folder.\n' +
      'To use this tool you need to have a dev script in your package.json that runs on port 5173.'
  )
  .version('1.0.0');

program
  .command('init')
  .description('Copy all needed files into your project root folder')
  .action(init);

program
  .command('test [filters...]')
  .description(
    'Start your dev server and run tests (cypress or vitest).\n' +
      'You can also add filters to run specific files, like this:\n' +
      '`plugga test --run .vg.`\n' +
      '`plugga test --run home admin order`'
  )
  .option('-r, --run', 'run all tests once in the terminal')
  .option('-f, --framework <string>', 'select test framework: cypress (default) or vitest')
  .option('-v, --vitest', 'select vitest as test framework')
  .option('-t, --ts', 'enable execution with typescript files')
  .action(test);

program
  .command('update')
  .description('Download the latest assigment tests to your project')
  .action(update);

program
  .command('mongo')
  .description('Install MongoDB Community Edition (for autograder))')
  .action(mongo);

program
  .command('debug')
  .description('Can be used to debug functions in isolation while developing')
  .action(debug);

program.parse();
